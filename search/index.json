[{"content":"2P2E åˆæ­¥å®ç°å›¾ç‰‡è½¬ExcelåŠŸèƒ½ é¡¹ç›®ç›®æ ‡ 2P2Eï¼ˆPDF\u0026amp;PIC to Excelï¼‰ é¡¹ç›®èƒŒæ™¯\næœ‰ä¸€ç§éœ€æ±‚ï¼Œä¸ç—›ï¼Œèƒ½å¿ï¼Œé¢‘åº¦ä¹Ÿä¸ä¸€å®šé«˜ï¼Œä½†æ˜¯æ¶å¿ƒèµ·æ¥ä¹Ÿå¾ˆæ¶å¿ƒ\né‚£å°±æ˜¯æŠŠä¸Šé¢çš„pdfå’Œpicå˜æˆå¯ç¼–è¾‘çš„excelè¡¨æ ¼çš„éœ€æ±‚ ï¼Œæ€è€ƒAIæ—¶ä»£ï¼Œè¿™ä»¶äº‹å¯ä»¥ä¸å¯ä»¥å˜æˆä¸€ä¸ªäº§å“\næ ¸å¿ƒæŠ€æœ¯\nåŒ…æ‹¬ä½†ä¸é™äºï¼š\nå›¾ç‰‡è‡ªåŠ¨æ”¹å–„ï¼ˆäºŒå€¼åŒ–ã€çŸ©å½¢çŸ«æ­£ã€æ•£ç„¦æ¨¡ç³Šå¤„ç†ç­‰ï¼‰ OCR PDFå»æ°´å°ã€è§£å¯†ã€æ–‡å­—è§£æ æ¨¡å¼è¯†åˆ«ï¼ˆå¦‚è¡¨æ ¼åŒºåŸŸè¯†åˆ«ã€æ‰‹å†™ä½“è¯†åˆ«ç­‰ï¼‰ æ‰¹é‡å¤„ç† å·¥ç¨‹éœ€æ±‚\nåšæˆäº§å“ï¼Œå–å‡ºå»\nè¯¦ç»†éœ€æ±‚ 1. å®ç°å‰åç«¯åˆ†ç¦» ç›®å‰çš„ç¨‹åºæœ‰ä¸¤å¤§ç¼ºç‚¹ï¼š1. ä½¿ç”¨å‘½ä»¤è¡Œäº¤äº’ï¼Œå¯¹ç”¨æˆ·å¹¶ä¸å‹å¥½ 2. python ç¨³å®šæ€§è¾ƒå·®ï¼Œå¯¹ç¯å¢ƒè¦æ±‚é«˜ã€‚é‰´äºæ­¤ï¼Œæˆ‘ä»¬åº”è¯¥è®©ç¨‹åºå‰åç«¯åˆ†ç¦»ï¼šå°†ç›®å‰çš„æ‰€æœ‰å†…å®¹éƒ½å½’æ¡£è‡³ serverï¼Œå°†å…¶åŒ…è£…æˆ API æ¥å£åœ¨äº‘ç«¯æœåŠ¡å™¨è¿è¡Œï¼Œä¹‹åç”¨å…¶ä»–ç¨³å®šçš„è¯­è¨€ï¼ˆå¦‚ Rustã€Qt ç­‰ï¼‰å†™ä¸€ä¸ª clientï¼Œæ‰€æœ‰è®¡ç®—å’Œè¯·æ±‚éƒ½é€šè¿‡ API å®Œæˆè€Œéæœ¬åœ°è®¡ç®—ï¼Œåªå¯¹ç”¨æˆ·å¼€æ”¾ clientã€‚åŒæ—¶è¿™æ ·ä¹Ÿå¯ä»¥æœ‰æ›´å¤šä¸°å¯Œçš„äº¤äº’åŠŸèƒ½ï¼Œå¯ä»¥è®©ç”¨æˆ·æ–¹ä¾¿åœ°åœ¨ä¸­é€”æ‰‹åŠ¨æˆ–å€ŸåŠ©å¤§æ¨¡å‹è°ƒæ•´æ•°æ®é›†æˆ–ä¸­é—´ç»“æœã€‚\n2. å¯¹å›¾ç‰‡è¿›è¡Œè¿›ä¸€æ­¥é¢„å¤„ç† é¢„å¤„ç†åœ¨ preprocess_pic.py ä¸­å®Œæˆï¼Œç›®å‰åªæœ‰ç”¨æˆ·æ‰‹åŠ¨é€‰å®šåŒºåŸŸçš„åŠŸèƒ½ã€‚äº‹å®ä¸Šé‡åˆ°çš„å›¾ç‰‡å¯èƒ½æœ‰å„ç§æƒ…å†µï¼šæ‹å±ã€æ»¤é•œã€æ¨¡ç³Šç­‰ï¼Œä¸€æ–¹é¢å¯ä»¥è®©ç”¨æˆ·æ‰‹åŠ¨è°ƒæ•´å›¾ç‰‡å‚æ•°ï¼Œå¦ä¸€æ–¹é¢å¸Œæœ›åœ¨è¿™é‡Œä½¿ç”¨å¤§æ¨¡å‹è‡ªåŠ¨è°ƒæ•´å›¾ç‰‡å‚æ•°ï¼Œäººå·¥å¯ä»¥åªåšå¾®è°ƒã€‚\nè¿˜æœ‰ä¸€ç§ç‰¹æ®Šçš„é¢„å¤„ç†ï¼šæ‰‹å†™æ–‡å­—ã€‚æœ‰æ—¶å€™ç”¨æˆ·ä¼šæ‹æ‰‹å†™çš„è¡¨æ ¼ï¼Œå…¶ä¸­æœ€éš¾å¤„ç†çš„å°±æ˜¯æ‰‹å†™æ–‡å­—äº†ï¼Œå¤§éƒ¨åˆ†å›¾ç‰‡è½¬è¡¨æ ¼çš„ API éƒ½ä¸èƒ½å¾ˆå¥½åœ°å¤„ç†å®ƒä»¬ã€‚æˆ‘çš„æƒ³æ³•æ˜¯åœ¨é¢„å¤„ç†é˜¶æ®µå°±æŠŠå®ƒä»¬è§£å†³æ‰ï¼šç”¨å¤§æ¨¡å‹æ‰¾åˆ°æ‰€æœ‰æ‰‹å†™æ–‡å­—ï¼Œä½¿ç”¨é€‚ç”¨äºæ‰‹å†™æ–‡å­—çš„ OCR æ¨¡å‹è¯†åˆ«æˆå°åˆ·ä½“åæ›¿æ¢å›å›¾ç‰‡é‡Œï¼Œè¿™æ ·å°±èƒ½ä¿è¯æä¾›ç»™ç¨‹åºä¸»ä½“çš„å›¾ç‰‡é‡Œæ°¸è¿œåªæœ‰å°åˆ·ä½“ã€‚\n3. æ”¯æŒæ‰¹é‡å¤„ç† å•å¼ å›¾ç‰‡æ¯ä¸ªäººéƒ½å¯ä»¥è½»æ¾æå–å‡ºå†…å®¹ï¼Œæ‰¹é‡çš„åœºæ™¯æ‰æ˜¯çœŸæ­£éœ€è¦ç¨‹åºè¾…åŠ©çš„åœ°æ–¹ã€‚æˆ‘ä»¬éœ€è¦æ”¯æŒæ‰¹é‡è¯»å–æ•°æ®å¹¶å­˜å‚¨åˆ°ä¸€ä¸ªæ•°æ®åº“é‡Œè¿›è¡Œé—®ç­”ã€‚æ¯”å¦‚ç»™å‡ºå…¨ç­æ‰€æœ‰äººçš„ä½“æ£€å•å›¾ç‰‡ï¼Œå¯ä»¥ç›´æ¥é—®å‡ºè¿™ä¸ªç­æœ‰å“ªäº›äººè§†åŠ›åœ¨ 4.5 ä»¥ä¸Šã€‚ç»™å‡ºä¸€è½¦åº“çš„å‘ç¥¨çš„å›¾ç‰‡ï¼Œå¯ä»¥ç›´æ¥ç®—å‡ºæ€»é¢ç­‰ç­‰ã€‚ä½†è¿™ä¸ªè¿‡ç¨‹æœ‰äº›å›°éš¾ï¼Œéœ€è¦æ€è€ƒçš„ç‚¹æ˜¯ï¼š1. æ•°æ®é‡å¤Ÿå¤§æ—¶è‚¯å®šåªè°ƒç”¨ä¸€æ¬¡å¤§æ¨¡å‹å°±å¤„ç†å¥½ã€‚å¯¹è¾“å…¥æ•°æ®åˆ‡ç‰‡åè¿›è¡Œåˆ†åˆ«å¤„ç†ï¼Œå¦‚ä½•è®©å¤§æ¨¡å‹ç”Ÿæˆå‰åæ ¼å¼å®Œå…¨ç»Ÿä¸€çš„è¡¨æ ¼ï¼Œå¦‚ä½•å®Œæˆæ‹¼æ¥ï¼Ÿ 2. æœ‰æ—¶å€™æœ¬èº«å›¾ç‰‡ä¸­çš„æ•°æ®æ ¼å¼å‰åå°±ä¸å®Œå…¨ç»Ÿä¸€ï¼Œï¼ˆæ¯”å¦‚ 90 åˆ†å’Œä¼˜ç§€ï¼‰ï¼Œè¿™æ—¶å€™å¦‚ä½•ç»Ÿä¸€æ ¼å¼ä»¥æ–¹ä¾¿ç»Ÿè®¡ï¼Ÿæˆ‘è§‰å¾—å¯èƒ½éœ€è¦ç”¨æˆ·è¡¥å……äº¤æ¢ä¸€äº›å…³äºå†…å®¹çš„æè¿°ä»¥çº æ­£å¹¶å­˜å‚¨ã€‚\nè¦æƒ³å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œå¯èƒ½è¦ä¿®æ”¹çš„åœ°æ–¹ä¸æ­¢ä¸€å¤„ï¼Œè¯·åŠ¡å¿…ç¡®ä¿æ¨¡å—åŒ–ä¸”æ¯ä¸ªæ¨¡å—éƒ½åœ¨æ­£ç¡®çš„æ–‡ä»¶é‡Œã€‚\n4. æ”¯æŒå„ç§æ ¼å¼ æˆ‘ä»¬è¿˜æƒ³æ”¯æŒä¸€äº›å…¶ä»–æ ¼å¼ï¼Œæ¯”å¦‚ .pdf æ–‡ä»¶ã€‚å®ç° 3 åè¿™é‡Œçš„å®ç°å°±ç®€å•å¤šäº†ï¼Œå¯ä»¥æ‰¹é‡è½¬æˆå›¾ç‰‡åå†å¤„ç†ã€‚åŒæ—¶ï¼Œæ‰¹é‡çš„æ•°æ®é›†ä¹Ÿåº”å½“å…è®¸å‡ºç°å›¾ç‰‡ã€è¡¨æ ¼ã€pdfã€æ•°æ®åº“æ··æ‚çš„æƒ…å†µï¼Œå¿…é¡»è¦èƒ½æ­£å¸¸å¤„ç†ã€‚åŒæ—¶ä¹Ÿè¦æ”¯æŒä¸€ä¸ªå·¥ä½œç°¿çš„å¤šå¼ å·¥ä½œè¡¨ã€‚\n5. å…è®¸å¤šæ¨¡æ€çš„è¾“å‡º æœ‰çš„æ—¶å€™æˆ‘ä»¬æƒ³è¦å¤„ç†æ•´å¼ è¡¨æ ¼ï¼ˆæ•´ç†æ ¼å¼ï¼Œæå–éƒ¨åˆ†åˆ—ï¼‰è€Œéå¾—åˆ°ä¸€ä¸ªç»Ÿè®¡ç»“æœï¼Œè¿™æ—¶å€™æˆ‘ä»¬åº”å½“èƒ½å¤Ÿæ­£ç¡®åœ°ç”Ÿæˆç”¨æˆ·éœ€è¦çš„æ•°æ®åº“ã€è¡¨æ ¼ç­‰ã€‚\n6. æ”¯æŒç¼“å­˜ ç›®å‰çš„é¢„å¤„ç†æ—¶é—´è¿‡é•¿ï¼Œå¤„ç†è¿‡çš„å›¾ç‰‡å†æ¬¡è¿è¡Œç¨‹åºè¿›è¡Œå¯¹è¯éœ€è¦å†æ¬¡å¤„ç†å®åœ¨ä¸å¤ªå‹å–„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ MD5ã€SHA1 ç­‰å“ˆå¸Œå€¼åˆ¤æ–­è¯¥å›¾ç‰‡æ˜¯å¦æœ‰å¤„ç†è¿‡ï¼Œå¦‚æœæœ‰ç›´æ¥åˆ©ç”¨ä¹‹å‰çš„ç¼“å­˜å³å¯ã€‚\n7. æ”¶é›†æ•°æ®ã€è®­ç»ƒè‡ªå·±çš„ OCR æ¨¡å‹ å›¾ç‰‡å¤„ç†è¿™å—æˆ‘å¯ä¸æƒ³ä¸€ç›´æŒ‡æœ›ç”¨ API å‘€ï¼Œæ˜æ˜æœ‰å¾ˆå¤šä¼˜ç§€çš„å¼€æºæ·±åº¦å­¦ä¹ ç½‘ç»œè®­ç»ƒä¸€ä¸‹å°±èƒ½ç”¨äº†ã€‚é€‰æ‹©åˆé€‚çš„ç½‘ç»œï¼Œå‰æœŸå…ˆç”¨ API è¿‡æ¸¡å¹¶æ”¶é›†æ•°æ®ï¼ŒåæœŸè®­ç»ƒæˆ‘ä»¬è‡ªå·±çš„æ¨¡å‹ï¼\n8. éªŒè¯æ‰€æœ‰ä¸­é—´ç»“æœå¹¶ä¿®å¤ å¤§æ¨¡å‹æ˜¯è‚¯å®šä¼šçŠ¯é”™çš„ï¼Œæ›´ä½•å†µæ˜¯è‡ªç„¶è¯­è¨€å¤§æ¨¡å‹ï¼Œè€Œæˆ‘ä»¬åŸºæœ¬æ‰€æœ‰çš„äº¤äº’éƒ½æ˜¯é€šè¿‡ prompt å·¥ç¨‹å®ç°çš„ï¼Œæ›´ä¸ç¨³å®šäº†ï¼Œä¸€ä½†é“¾å¼è°ƒç”¨çš„ä»»ä½•ä¸€ä¸ªç¯èŠ‚å‡ºé”™éƒ½ä¼šæœ‰ä¸¥é‡åæœã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ï¼š\nå®ç°ä¸€ä¸ª validate çš„æ–¹æ³•éªŒè¯æ‰€æœ‰ç»“æœæ˜¯å¦ç¬¦åˆæ ¼å¼ï¼Œç›®å‰æˆ‘å†™å¥½çš„å¤ªç®€å•äº†ï¼Œåªèƒ½åˆ¤æ–­è¡Œæ•°å’Œåˆ—æ•°ï¼Œäº‹å®ä¸Šåˆæ³•æ€§åˆ¤æ–­è¿œä¸æ­¢è¿™äº›ã€‚ å®ç°ä¸€ä¸ª fix æ–¹æ³•ï¼Œç›®å‰æˆ‘çš„å®ç°å¤§å®¶çœ‹æºç å°±çŸ¥é“ï¼Œåªèƒ½å¤„ç†ç®€å•çš„æ ¼å¼é”™è¯¯ã€‚äº‹å®ä¸Šï¼Œè¿™é‡Œæ˜¯å¯ä»¥é€šè¿‡ï¼ˆå’Œç”¨æˆ·äº¤äº’è·å¾—æ›´å¤šæç¤ºè¯ï¼‰å†æ¬¡ç”Ÿæˆä¿®å¤çš„ã€‚ 9. å¾®è°ƒè‡ªå·±çš„ csv ç”Ÿæˆ / æ•°æ®åº“ç”Ÿæˆæ¨¡å‹ å¼ƒç”¨æç¤ºè¯å·¥ç¨‹ï¼Œè¿™ä¸ªå¥½éš¾ qwq\nç›®å‰å®ç°çš„å·¥ä½œ è°ƒç”¨è±†åŒ…å¤§æ¨¡å‹çš„èƒ½åŠ› è¿™é‡Œä½¿ç”¨äº†è±†åŒ…çš„æ¨¡å‹ï¼Œæ¥å¸®åŠ©æˆ‘è¯†åˆ«ã€‚è€ƒè™‘åˆ°ä½¿ç”¨å¤§æ¨¡å‹å¯ä»¥å¸®åŠ©æˆ‘å¤„ç†å¾ˆå¤šcorner case ï¼Œæ¯”å¦‚å®ƒå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šè¿›è¡Œæ¨æ–­ï¼Œç„¶åä¹Ÿå¯ä»¥åšæ•°æ®çš„æ¸…æ´—å’Œç­›é€‰ï¼Œä½†æ˜¯ç¾ä¸­ä¸è¶³çš„æ˜¯å¯¹äºæµ·é‡çš„æ•°æ®çš„æ—¶å€™ä»–çš„è¿è¡Œé€Ÿåº¦çœŸçš„å¤ªä½ä¸‹äº†ï¼ˆå³ä½¿æˆ‘å……é’±äº†ä¹Ÿæ˜¯è¿™æ ·çš„ï¼‰ åŒæ—¶æˆ‘æ˜¯æŠŠå›¾ç‰‡æå–å’Œæ•°æ®æ¸…æˆåˆ†åˆ°ä¸¤æ¬¡ä¸åŒçš„è°ƒç”¨é‡Œé¢äº†ï¼Œè¿™æ ·å¯èƒ½ä¼šæ•ˆæœæ›´å¥½ä¸€äº›ï¼ˆè¯´ç™½äº†å°±æ˜¯æ‹†è§£å¼€äº†ï¼‰ï¼Œä½†æ˜¯å°±æ˜¯è¿™æ ·ä¼šå¯¼è‡´æ•ˆç‡é™ä½ æ³¨æ„åé¢ä½ è¦æœ¬åœ°è·‘è¦è‡ªå·±è®¾ç½®API-KEYå’Œæ¨¡å‹åå­—ï¼ˆè¿™ä¸ªæ¨¡å‹çš„è°ƒç”¨æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œä¸æ˜¯ä½ ç®€å•åˆ›å»ºä¸€ä¸ªAPI-KEYå°±è¡Œäº†çš„ï¼Œè¿˜éœ€è¦æŒ‰ç…§ä¸‹é¢çš„æ–‡æ¡£ä¸€æ­¥æ­¥è®¾ç½®ï¼Œæ¯”deepseekå’Œkimiéƒ½è¦éº»çƒ¦ç‚¹ï¼‰ ä½†æ˜¯è¿™é‡Œç”¨çš„SDKå¹¶ä¸æ˜¯OpenAiçš„ï¼Œæ‰€ä»¥å…¼å®¹æ€§æœ‰ç‚¹å·® åé¢å¯ä»¥è€ƒè™‘ç»™å®¢æˆ·åŠ ä¸€ä¸ªè‡ªå·±éœ€è¦è¾“å…¥çš„promptçš„åœ°æ–¹ï¼Œè¿™æ ·å¯ä»¥å®¢æˆ·æŒ‰ç…§è‡ªå·±çš„è¦æ±‚æ¥è¾“å…¥promptä¸€å¹¶åŠ åˆ°ç¨‹åºçš„promptåé¢ ä½†æ˜¯å› ä¸ºæˆ‘ä¸çŸ¥é“åˆ˜èˆ’ç„¶åŒå­¦æ˜¯æ€ä¹ˆæŠ“æ¥çš„wpsçš„ä¸œè¥¿çš„ï¼Œæ‰€ä»¥ä¸å¤ªæ¸…æ¥šwpsçš„æ•ˆæœ ç›¸å…³å‚è€ƒèµ„æ–™ï¼š\nå¿«é€Ÿå…¥é—¨-è°ƒç”¨æ¨¡å‹æœåŠ¡\u0026ndash;ç«å±±æ–¹èˆŸå¤§æ¨¡å‹æœåŠ¡å¹³å°-ç«å±±å¼•æ“\nè§†è§‰ç†è§£\u0026ndash;ç«å±±æ–¹èˆŸå¤§æ¨¡å‹æœåŠ¡å¹³å°-ç«å±±å¼•æ“\nä½¿ç”¨Cursorç¼–ç¨‹ æˆ‘å‘ç°ä½¿ç”¨AIçš„åŠ›é‡çœŸçš„å¾ˆå¼ºå¤§ï¼Œä½ åªéœ€è¦æ’°å†™åˆé€‚çš„éœ€æ±‚æ–‡æ¡£ï¼Œç„¶åå¯¹ç»†èŠ‚é€‚å½“è¿›è¡Œä¿®æ”¹ï¼Œä½ å°±å¯ä»¥å¿«é€Ÿå†™å‡ºæ¥ä¸€ä¸ªå¯ä»¥runçš„ç¨‹åºã€‚ä»å¼€å§‹å†™åˆ°ç›®å‰é¡¹ç›®çš„æˆ‘åªç”¨äº†3ä¸ªå°æ—¶æ—¶é—´ï¼ˆäº‹å®ä¸Šé‡Œé¢å¾ˆå¤šä»£ç æˆ‘æ˜¯çœ‹ä¸æ‡‚çš„ï¼‰\næˆ‘ä¸ªäººå¤šå°‘è§‰å¾—å‰é¢è¯¦ç»†éœ€æ±‚çš„2å¹¶æ²¡æœ‰è¿‡å¤šçš„å¿…è¦ï¼Ÿå› ä¸ºç›®å‰æ¥çœ‹è±†åŒ…å¯¹äºæ‰‹å†™çš„è¯†åˆ«å·²ç»å¾ˆå¥½äº†ï¼ˆæˆ‘è¯•äº†è¯•è¶…è¿‡äº†deepseekï¼‰ã€‚åªè¦ä¸æ˜¯æ‰‹å†™çš„å¾ˆéš¾çœ‹çš„éƒ½å¯ä»¥è¯†åˆ«/æˆ–è€…æ¶‚æŠ¹è¿‡å¤šçš„åœ°æ–¹éƒ½åŸºæœ¬å¯ä»¥è¯†åˆ«\nä½¿ç”¨Cursorå¸®åŠ©æˆ‘æ’°å†™äº†å¾ˆè¯¦ç»†çš„promptäº†ï¼ˆå¯èƒ½è¿™é‡ŒçœŸçš„æ˜¯å› ä¸ºæˆ‘ç”¨çš„è±†åŒ…æ¨¡å‹æœ‰ä¸€ç‚¹ç‚¹è ¢å§ï¼Œå¯¹äºä¸‹é¢çš„å›¾æ€»æ˜¯æå–ä¸å‡ºæ¥CACçš„å­—æ®µï¼Œä½†æ˜¯æˆ‘ç”¨å®¢æˆ·ç«¯ç•Œé¢çš„å°±å¯ä»¥\næµ‹è¯•æ•°æ®å’Œæ•ˆæœ å›¾ç‰‡éƒ¨åˆ† é™¤äº†ä¸Šé¢æˆ‘è¯´çš„ç¬¬å››ä¸ªå›¾åå­—CACå› ä¸ºè¢«æ¶‚æŠ¹äº†ä¹‹å¤–çœ‹ä¸æ¸…æ¥šï¼Œå…¶ä»–çš„éƒ½è¿˜æ¯”è¾ƒå‡†ç¡®ï¼ˆæ‰‹å†™çš„å­—å¾ˆä¸‘ï¼Œå‹¿å–·\nç”šè‡³å¯¹äºæˆ‘å­—æ®µåå­—å’Œæˆ‘è¡¨æ ¼ä¿¡æ¯ä¸ºåŒä¹‰è¯çš„æ—¶å€™ä»–ä¾ç„¶èƒ½å¤Ÿæ¯”è¾ƒå‡†ç¡®çš„è¿”å›å‡ºæ¥\næ•ˆæœå¦‚ä¸‹\næˆ‘æ˜¯cloneåˆ˜èˆ’ç„¶åŒå­¦çš„ä»“åº“åï¼Œç›´æ¥åœ¨ä»–é‚£ä¸ªé¡¹ç›®é‡Œé¢å»æ–°å†™çš„ä»£ç ï¼Œæ‰€ä»¥Cursoré‡Œé¢å®ç°çš„UIç•Œé¢å’Œè£åˆ‡åŠŸèƒ½åº”è¯¥éƒ½æ˜¯å‚è€ƒäº†åˆ˜èˆ’ç„¶åŒå­¦çš„ä»£ç \nä»£ç éƒ¨åˆ† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 import tkinter as tk from tkinter import filedialog, ttk from PIL import Image, ImageTk import json import pandas as pd from typing import List, Dict import base64 import io from volcenginesdkarkruntime import Ark import os import datetime class CropWindow: def __init__(self, parent, image_path, callback): self.top = tk.Toplevel(parent) self.top.title(\u0026#34;è£åˆ‡å›¾ç‰‡\u0026#34;) self.callback = callback # åŠ è½½åŸå§‹å›¾ç‰‡ self.original_image = Image.open(image_path) # è®¡ç®—æ˜¾ç¤ºå°ºå¯¸ display_size = (800, 600) self.display_image = self.original_image.copy() self.display_image.thumbnail(display_size) # è®¡ç®—ç¼©æ”¾æ¯”ä¾‹ self.scale_x = self.original_image.width / self.display_image.width self.scale_y = self.original_image.height / self.display_image.height # åˆ›å»ºç”»å¸ƒ self.canvas = tk.Canvas(self.top, width=self.display_image.width, height=self.display_image.height) self.canvas.pack(expand=True) # æ˜¾ç¤ºå›¾ç‰‡ self.photo = ImageTk.PhotoImage(self.display_image) self.canvas.create_image(0, 0, image=self.photo, anchor=tk.NW) # è£åˆ‡åŒºåŸŸå˜é‡ self.start_x = None self.start_y = None self.rect = None self.crop_coords = None # ç»‘å®šé¼ æ ‡äº‹ä»¶ self.canvas.bind(\u0026#34;\u0026lt;ButtonPress-1\u0026gt;\u0026#34;, self.on_press) self.canvas.bind(\u0026#34;\u0026lt;B1-Motion\u0026gt;\u0026#34;, self.on_drag) self.canvas.bind(\u0026#34;\u0026lt;ButtonRelease-1\u0026gt;\u0026#34;, self.on_release) # æ·»åŠ æŒ‰é’® button_frame = ttk.Frame(self.top) button_frame.pack(pady=5) ttk.Button(button_frame, text=\u0026#34;ç¡®è®¤è£åˆ‡\u0026#34;, command=self.crop_and_close).pack(side=tk.LEFT, padx=5) ttk.Button(button_frame, text=\u0026#34;è·³è¿‡è£åˆ‡\u0026#34;, command=self.skip_crop).pack(side=tk.LEFT, padx=5) def on_press(self, event): \u0026#34;\u0026#34;\u0026#34;é¼ æ ‡æŒ‰ä¸‹æ—¶çš„å¤„ç†\u0026#34;\u0026#34;\u0026#34; self.start_x = event.x self.start_y = event.y # å¦‚æœå·²ç»æœ‰çŸ©å½¢ï¼Œåˆ é™¤å®ƒ if self.rect: self.canvas.delete(self.rect) self.rect = None def on_drag(self, event): \u0026#34;\u0026#34;\u0026#34;é¼ æ ‡æ‹–åŠ¨æ—¶çš„å¤„ç†\u0026#34;\u0026#34;\u0026#34; if self.start_x is None: return # å¦‚æœå·²ç»æœ‰çŸ©å½¢ï¼Œåˆ é™¤å®ƒ if self.rect: self.canvas.delete(self.rect) # åˆ›å»ºæ–°çŸ©å½¢ self.rect = self.canvas.create_rectangle( self.start_x, self.start_y, event.x, event.y, outline=\u0026#39;red\u0026#39; ) def on_release(self, event): \u0026#34;\u0026#34;\u0026#34;é¼ æ ‡é‡Šæ”¾æ—¶çš„å¤„ç†\u0026#34;\u0026#34;\u0026#34; if self.start_x is None: return # ç¡®ä¿æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„é€‰æ‹©åŒºåŸŸ x1 = min(self.start_x, event.x) y1 = min(self.start_y, event.y) x2 = max(self.start_x, event.x) y2 = max(self.start_y, event.y) # ä¿å­˜è£åˆ‡åæ ‡ï¼ˆè€ƒè™‘ç¼©æ”¾æ¯”ä¾‹ï¼‰ self.crop_coords = ( int(x1 * self.scale_x), int(y1 * self.scale_y), int(x2 * self.scale_x), int(y2 * self.scale_y) ) def crop_and_close(self): \u0026#34;\u0026#34;\u0026#34;è£åˆ‡å›¾ç‰‡å¹¶å…³é—­çª—å£\u0026#34;\u0026#34;\u0026#34; if self.crop_coords: # è£åˆ‡å›¾ç‰‡ cropped_image = self.original_image.crop(self.crop_coords) # è°ƒç”¨å›è°ƒå‡½æ•° self.callback(cropped_image) self.top.destroy() def skip_crop(self): \u0026#34;\u0026#34;\u0026#34;è·³è¿‡è£åˆ‡\u0026#34;\u0026#34;\u0026#34; self.callback(self.original_image) self.top.destroy() class ImageProcessorApp: def __init__(self, root): self.root = root self.root.title(\u0026#34;å›¾ç‰‡è¡¨æ ¼æå–å™¨\u0026#34;) self.root.geometry(\u0026#34;800x600\u0026#34;) # åˆå§‹åŒ–APIå®¢æˆ·ç«¯ self.client = Ark(api_key=\u0026#39;\u0026#39;) #ä¿®æ”¹APIkey self.client.api_key = \u0026#34;1c477866-b675-423e-b205-3c285fb15925\u0026#34; # å­˜å‚¨é€‰ä¸­çš„å›¾ç‰‡ self.images: List[Dict] = [] self.current_crop_index = 0 self.pending_images = [] # å­˜å‚¨æå–å­—æ®µå’ŒExcelå¯¼å‡ºè·¯å¾„ self.fields = [\u0026#34;å§“å\u0026#34;, \u0026#34;è½¦æ¬¡\u0026#34;, \u0026#34;å‡ºå‘åœ°\u0026#34;, \u0026#34;ç›®çš„åœ°\u0026#34;, \u0026#34;è½¦ç¥¨ä»·æ ¼\u0026#34;] # é»˜è®¤å­—æ®µ self.excel_output_path = \u0026#34;\u0026#34; # æ·»åŠ å½“å‰æ˜¾ç¤ºå›¾ç‰‡çš„ç´¢å¼• self.current_display_index = 0 self.setup_ui() def setup_ui(self): # åˆ›å»ºä¸»æ¡†æ¶ self.main_frame = ttk.Frame(self.root) self.main_frame.pack(fill=tk.BOTH, expand=True, padx=10, pady=10) # åˆ›å»ºæ°´å¹³æ–¹å‘çš„ä¸»é¢æ¿åˆ†éš”å™¨ self.main_panel = ttk.PanedWindow(self.main_frame, orient=tk.HORIZONTAL) self.main_panel.pack(fill=tk.BOTH, expand=True) # åˆ›å»ºå·¦ä¾§é¢æ¿ï¼ˆå¯ä¼¸ç¼©ï¼‰ self.left_panel = ttk.PanedWindow(self.main_panel, orient=tk.HORIZONTAL) self.main_panel.add(self.left_panel, weight=4) # å·¦ä¾§å æ¯”æ›´å¤§ # åˆ›å»ºå·¦ä¾§ç¼©ç•¥å›¾åŒºåŸŸ self.thumbnail_frame = ttk.LabelFrame(self.left_panel, text=\u0026#34;å·²ä¸Šä¼ å›¾ç‰‡\u0026#34;) self.left_panel.add(self.thumbnail_frame, weight=1) # åˆ›å»ºç¼©ç•¥å›¾æ»šåŠ¨åŒºåŸŸ self.thumb_canvas = tk.Canvas(self.thumbnail_frame, width=150) self.thumb_scrollbar = ttk.Scrollbar(self.thumbnail_frame, orient=tk.VERTICAL, command=self.thumb_canvas.yview) self.thumb_canvas.configure(yscrollcommand=self.thumb_scrollbar.set) self.thumb_scrollbar.pack(side=tk.RIGHT, fill=tk.Y) self.thumb_canvas.pack(side=tk.LEFT, fill=tk.BOTH, expand=True) self.thumbnail_container = ttk.Frame(self.thumb_canvas) self.thumb_canvas.create_window((0, 0), window=self.thumbnail_container, anchor=tk.NW) # åˆ›å»ºä¸­å¤®å›¾ç‰‡æ˜¾ç¤ºåŒºåŸŸ self.display_frame = ttk.Frame(self.left_panel) self.left_panel.add(self.display_frame, weight=3) # æ·»åŠ å›¾ç‰‡å¯¼èˆªæŒ‰é’® nav_frame = ttk.Frame(self.display_frame) nav_frame.pack(fill=tk.X, pady=5) ttk.Button(nav_frame, text=\u0026#34;ä¸Šä¸€å¼ \u0026#34;, command=self.prev_image).pack(side=tk.LEFT, padx=5) ttk.Button(nav_frame, text=\u0026#34;ä¸‹ä¸€å¼ \u0026#34;, command=self.next_image).pack(side=tk.LEFT, padx=5) ttk.Button(nav_frame, text=\u0026#34;é€‰æ‹©å›¾ç‰‡\u0026#34;, command=self.select_images).pack(side=tk.LEFT, padx=5) ttk.Button(nav_frame, text=\u0026#34;è£å‰ªå›¾ç‰‡\u0026#34;, command=self.crop_current_image).pack(side=tk.LEFT, padx=5) ttk.Button(nav_frame, text=\u0026#34;å¤„ç†å›¾ç‰‡\u0026#34;, command=self.process_images).pack(side=tk.LEFT, padx=5) ttk.Button(nav_frame, text=\u0026#34;æ¸…ç©ºå›¾ç‰‡\u0026#34;, command=self.clear_images).pack(side=tk.LEFT, padx=5) # åˆ›å»ºä¸»å›¾ç‰‡æ˜¾ç¤ºåŒºåŸŸ self.main_image_label = ttk.Label(self.display_frame) self.main_image_label.pack(fill=tk.BOTH, expand=True) # æ·»åŠ å›¾ç‰‡åºå·æ˜¾ç¤º self.image_counter_label = ttk.Label(self.display_frame, text=\u0026#34;\u0026#34;) self.image_counter_label.pack(pady=5) # åˆ›å»ºå³ä¾§è®¾ç½®åŒºåŸŸ self.settings_frame = ttk.Frame(self.main_panel) self.main_panel.add(self.settings_frame, weight=1) # å³ä¾§å æ¯”è¾ƒå° # å­—æ®µè®¾ç½®åŒºåŸŸ field_settings = ttk.LabelFrame(self.settings_frame, text=\u0026#34;å­—æ®µè®¾ç½®\u0026#34;) field_settings.pack(fill=tk.X, pady=5, padx=5) ttk.Label(field_settings, text=\u0026#34;æå–å­—æ®µï¼ˆä¸€è¡Œä¸€ä¸ªï¼‰ï¼š\u0026#34;).pack(padx=5, pady=2) self.fields_text = tk.Text(field_settings, height=5, width=30) self.fields_text.pack(padx=5, pady=2) self.fields_text.insert(\u0026#39;1.0\u0026#39;, \u0026#34;\\n\u0026#34;.join(self.fields)) ttk.Button(field_settings, text=\u0026#34;æ›´æ–°å­—æ®µ\u0026#34;, command=self.update_fields).pack(padx=5, pady=5) # Excelè¾“å‡ºè·¯å¾„è®¾ç½® path_settings = ttk.LabelFrame(self.settings_frame, text=\u0026#34;å¯¼å‡ºè®¾ç½®\u0026#34;) path_settings.pack(fill=tk.X, pady=5, padx=5) ttk.Label(path_settings, text=\u0026#34;Excelå¯¼å‡ºè·¯å¾„ï¼š\u0026#34;).pack(padx=5, pady=2) self.path_var = tk.StringVar() ttk.Entry(path_settings, textvariable=self.path_var, width=30).pack(padx=5, pady=2) ttk.Button(path_settings, text=\u0026#34;é€‰æ‹©è·¯å¾„\u0026#34;, command=self.select_output_path).pack(padx=5, pady=5) def clear_images(self): \u0026#34;\u0026#34;\u0026#34;æ¸…ç©ºæ‰€æœ‰å·²åŠ è½½çš„å›¾ç‰‡\u0026#34;\u0026#34;\u0026#34; self.images.clear() self.current_display_index = 0 self.refresh_thumbnail_view() self.update_main_display() def refresh_thumbnail_view(self): \u0026#34;\u0026#34;\u0026#34;åˆ·æ–°å·¦ä¾§ç¼©ç•¥å›¾æ˜¾ç¤º\u0026#34;\u0026#34;\u0026#34; # æ¸…é™¤ç°æœ‰ç¼©ç•¥å›¾ for widget in self.thumbnail_container.winfo_children(): widget.destroy() # é‡æ–°æ·»åŠ ç¼©ç•¥å›¾ for i, img_info in enumerate(self.images): frame = ttk.Frame(self.thumbnail_container) frame.pack(pady=5, padx=5) # åˆ›å»ºç¼©ç•¥å›¾ thumb = img_info[\u0026#34;image\u0026#34;].copy() thumb.thumbnail((100, 100)) photo = ImageTk.PhotoImage(thumb) # åˆ›å»ºå›¾ç‰‡æ ‡ç­¾å’Œåˆ é™¤æŒ‰é’®çš„å®¹å™¨ thumb_frame = ttk.Frame(frame) thumb_frame.pack() # æ·»åŠ åºå·æ ‡ç­¾ ttk.Label(thumb_frame, text=f\u0026#34;{i + 1}/{len(self.images)}\u0026#34;).pack() label = ttk.Label(thumb_frame, image=photo) label.image = photo label.pack() # æ·»åŠ åˆ é™¤æŒ‰é’® ttk.Button(thumb_frame, text=\u0026#34;Ã—\u0026#34;, width=2, command=lambda idx=i: self.remove_image(idx)).pack() # ç»‘å®šç‚¹å‡»äº‹ä»¶ label.bind(\u0026#39;\u0026lt;Button-1\u0026gt;\u0026#39;, lambda e, idx=i: self.show_image(idx)) # æ›´æ–°æ»šåŠ¨åŒºåŸŸ self.thumbnail_container.update_idletasks() self.thumb_canvas.configure(scrollregion=self.thumb_canvas.bbox(\u0026#34;all\u0026#34;)) def remove_image(self, index): \u0026#34;\u0026#34;\u0026#34;åˆ é™¤æŒ‡å®šç´¢å¼•çš„å›¾ç‰‡\u0026#34;\u0026#34;\u0026#34; if 0 \u0026lt;= index \u0026lt; len(self.images): self.images.pop(index) if self.current_display_index \u0026gt;= len(self.images): self.current_display_index = max(0, len(self.images) - 1) self.refresh_thumbnail_view() self.update_main_display() def show_image(self, index): \u0026#34;\u0026#34;\u0026#34;æ˜¾ç¤ºæŒ‡å®šç´¢å¼•çš„å›¾ç‰‡\u0026#34;\u0026#34;\u0026#34; if 0 \u0026lt;= index \u0026lt; len(self.images): self.current_display_index = index self.update_main_display() def update_main_display(self): \u0026#34;\u0026#34;\u0026#34;æ›´æ–°ä¸»æ˜¾ç¤ºåŒºåŸŸçš„å›¾ç‰‡\u0026#34;\u0026#34;\u0026#34; if not self.images: self.main_image_label.configure(image=\u0026#39;\u0026#39;) self.image_counter_label.configure(text=\u0026#34;\u0026#34;) return img = self.images[self.current_display_index][\u0026#34;image\u0026#34;].copy() # è°ƒæ•´å›¾ç‰‡å¤§å°ä»¥é€‚åº”æ˜¾ç¤ºåŒºåŸŸ display_size = (600, 400) img.thumbnail(display_size) photo = ImageTk.PhotoImage(img) self.main_image_label.configure(image=photo) self.main_image_label.image = photo # æ›´æ–°å›¾ç‰‡åºå·æ˜¾ç¤º self.image_counter_label.configure( text=f\u0026#34;å½“å‰ç¬¬ {self.current_display_index + 1} å¼ ï¼Œå…± {len(self.images)} å¼ \u0026#34; ) def prev_image(self): \u0026#34;\u0026#34;\u0026#34;æ˜¾ç¤ºä¸Šä¸€å¼ å›¾ç‰‡\u0026#34;\u0026#34;\u0026#34; if self.images: self.current_display_index = (self.current_display_index - 1) % len(self.images) self.update_main_display() def next_image(self): \u0026#34;\u0026#34;\u0026#34;æ˜¾ç¤ºä¸‹ä¸€å¼ å›¾ç‰‡\u0026#34;\u0026#34;\u0026#34; if self.images: self.current_display_index = (self.current_display_index + 1) % len(self.images) self.update_main_display() def select_images(self): filepaths = filedialog.askopenfilenames( title=\u0026#34;é€‰æ‹©å›¾ç‰‡\u0026#34;, filetypes=[(\u0026#34;Image files\u0026#34;, \u0026#34;*.png *.jpg *.jpeg *.gif *.bmp\u0026#34;)] ) if not filepaths: return # åŠ è½½æ–°å›¾ç‰‡ for filepath in filepaths: try: image = Image.open(filepath) self.images.append({ \u0026#34;filepath\u0026#34;: filepath, \u0026#34;image\u0026#34;: image }) except Exception as e: tk.messagebox.showerror(\u0026#34;é”™è¯¯\u0026#34;, f\u0026#34;æ— æ³•åŠ è½½å›¾ç‰‡ {filepath}: {str(e)}\u0026#34;) # åˆ·æ–°æ˜¾ç¤º self.refresh_thumbnail_view() if self.images: self.show_image(len(self.images) - 1) def update_fields(self): field_text = self.fields_text.get(\u0026#39;1.0\u0026#39;, tk.END) self.fields = [f.strip() for f in field_text.split(\u0026#39;\\n\u0026#39;) if f.strip()] tk.messagebox.showinfo(\u0026#34;æˆåŠŸ\u0026#34;, \u0026#34;å­—æ®µå·²æ›´æ–°ï¼\u0026#34;) def select_output_path(self): folder_path = filedialog.askdirectory(title=\u0026#34;é€‰æ‹©Excelå¯¼å‡ºç›®å½•\u0026#34;) if folder_path: self.excel_output_path = folder_path self.path_var.set(folder_path) def process_images(self): if not self.images: tk.messagebox.showwarning(\u0026#34;è­¦å‘Š\u0026#34;, \u0026#34;è¯·å…ˆé€‰æ‹©å›¾ç‰‡ï¼\u0026#34;) return if not self.excel_output_path: tk.messagebox.showwarning(\u0026#34;è­¦å‘Š\u0026#34;, \u0026#34;è¯·å…ˆé€‰æ‹©Excelå¯¼å‡ºè·¯å¾„ï¼\u0026#34;) return all_data = [] for img_info in self.images: try: # å°†å›¾ç‰‡è½¬æ¢ä¸ºPNGæ ¼å¼ï¼ˆç¡®ä¿æ ¼å¼å…¼å®¹æ€§ï¼‰ img = img_info[\u0026#39;image\u0026#39;] buffered = io.BytesIO() # ç»Ÿä¸€è½¬æ¢ä¸ºPNGæ ¼å¼ if img.mode in (\u0026#39;RGBA\u0026#39;, \u0026#39;LA\u0026#39;) or (img.mode == \u0026#39;P\u0026#39; and \u0026#39;transparency\u0026#39; in img.info): # å¦‚æœå›¾ç‰‡å¸¦æœ‰é€æ˜é€šé“ï¼Œå…ˆè½¬æ¢ä¸ºRGB img = img.convert(\u0026#39;RGB\u0026#39;) img.save(buffered, format=\u0026#34;PNG\u0026#34;) img_str = base64.b64encode(buffered.getvalue()).decode(\u0026#39;utf-8\u0026#39;) # ç¬¬ä¸€æ¬¡æç¤ºè¯ä¼˜åŒ– prompt = ( f\u0026#34;è¯·ä»”ç»†åˆ†æè¿™å¼ å›¾ç‰‡ï¼Œæå–ä»¥ä¸‹å­—æ®µçš„ä¿¡æ¯å¹¶ä»¥JSONæ ¼å¼è¿”å›ï¼š{\u0026#39;, \u0026#39;.join(self.fields)}ã€‚\\n\u0026#34; \u0026#34;æ³¨æ„äº‹é¡¹ï¼š\\n\u0026#34; \u0026#34;1. å›¾ç‰‡ä¸­åŒ…å«æ‰‹å†™ä½“æ–‡å­—ï¼Œè¯·ç‰¹åˆ«æ³¨æ„ï¼š\\n\u0026#34; \u0026#34; - ä»”ç»†è¾¨è¯†æ¯ä¸ªæ‰‹å†™å­—ç¬¦ï¼ŒåŒ…æ‹¬æ½¦è‰å­—è¿¹\\n\u0026#34; \u0026#34; - æ³¨æ„è¾¨è¯†è‹±æ–‡å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šç¬¦å·\\n\u0026#34; \u0026#34; - å¯¹äºä¸ç¡®å®šçš„å­—ç¬¦ï¼Œå°è¯•ä»ä¸Šä¸‹æ–‡æ¨æ–­\\n\u0026#34; \u0026#34;2. å…³äºæ¶‚æŠ¹å’Œä¿®æ”¹çš„å¤„ç†ï¼š\\n\u0026#34; \u0026#34; - å¦‚æœ‰æ¶‚æŠ¹å†…å®¹ï¼Œä¼˜å…ˆè¯†åˆ«æ¶‚æŠ¹å¤„å‘¨å›´æˆ–ä¸Šæ–¹çš„æ–°å¢å†…å®¹\\n\u0026#34; \u0026#34; - å¯¹äºéƒ¨åˆ†æ¶‚æŠ¹ä½†ä»å¯è§çš„å†…å®¹ï¼Œå°è¯•è¯†åˆ«å¯è§éƒ¨åˆ†\\n\u0026#34; \u0026#34; - æ³¨æ„è¯†åˆ«æ‰¹æ³¨ã€æ›´æ­£æˆ–æ·»åŠ çš„å†…å®¹\\n\u0026#34; \u0026#34;3. ç‰¹æ®Šæƒ…å†µå¤„ç†ï¼š\\n\u0026#34; \u0026#34; - å¯¹äºç¼©å†™æˆ–ç®€å†™ï¼Œå°½å¯èƒ½è¿˜åŸå®Œæ•´å†…å®¹\\n\u0026#34; \u0026#34; - æ³¨æ„è¯†åˆ«è¡¨æ ¼è¾¹ç¼˜æˆ–è§’è½çš„ä¿¡æ¯\\n\u0026#34; \u0026#34; - å¯¹äºæ¨¡ç³Šä¸æ¸…çš„å†…å®¹ï¼Œæ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­\\n\u0026#34; \u0026#34;4. å¦‚æœæŸå­—æ®µä¿¡æ¯ç¡®å®æ— æ³•è¯†åˆ«æˆ–ä¸å­˜åœ¨ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²\\n\u0026#34; \u0026#34;5. ä¼˜å…ˆæå–æœ€æ–°çš„ã€æœ‰æ•ˆçš„ä¿¡æ¯ï¼Œå¿½ç•¥å·²è¢«æ˜ç¡®åˆ é™¤çš„å†…å®¹\u0026#34; ) messages = [ { \u0026#34;role\u0026#34;: \u0026#34;user\u0026#34;, \u0026#34;content\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;text\u0026#34;, \u0026#34;text\u0026#34;: prompt }, { \u0026#34;type\u0026#34;: \u0026#34;image_url\u0026#34;, \u0026#34;image_url\u0026#34;: { \u0026#34;url\u0026#34;: f\u0026#34;data:image/png;base64,{img_str}\u0026#34; } } ] } ] # å‘é€è¯·æ±‚ response = self.client.chat.completions.create( model=\u0026#34;ep-20250118110159-n2vsp\u0026#34;, messages=messages ) # è§£æç¬¬ä¸€æ¬¡å“åº” if response.choices and response.choices[0]: raw_result = json.loads(response.choices[0].message.content) # ä¿®æ”¹æ•°æ®æ•´ç†çš„æç¤ºè¯ organize_prompt = ( \u0026#34;æˆ‘éœ€è¦ä½ å¸®æˆ‘æ•´ç†ä»¥ä¸‹æ•°æ®åˆ°è§„èŒƒçš„æ ¼å¼ã€‚è¿™äº›æ•°æ®æ¥è‡ªå›¾ç‰‡è¯†åˆ«ç»“æœï¼Œéœ€è¦è¢«æ•´ç†æˆç‹¬ç«‹çš„è®°å½•ã€‚\\n\u0026#34; \u0026#34;åŸå§‹æ•°æ®å¦‚ä¸‹ï¼š\\n\u0026#34; f\u0026#34;{json.dumps(raw_result, ensure_ascii=False, indent=2)}\\n\\n\u0026#34; \u0026#34;è¯·ä½ å°†æ•°æ®å¤„ç†æˆåˆ—è¡¨æ ¼å¼ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå¯¹åº”ä¸€æ¡å®Œæ•´çš„è®°å½•ã€‚\\n\u0026#34; \u0026#34;å¤„ç†è¦æ±‚ï¼š\\n\u0026#34; \u0026#34;1. æ•°æ®æ‹†åˆ†å’Œæ•´ç†ï¼š\\n\u0026#34; \u0026#34; - å¦‚æœä»»ä½•å­—æ®µä¸­åŒ…å«å¤šä¸ªå€¼ï¼Œå°†å…¶æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹è®°å½•\\n\u0026#34; \u0026#34; - ç¡®ä¿æ‹†åˆ†åçš„æ¯æ¡è®°å½•åŒ…å«æ‰€æœ‰å¿…è¦å­—æ®µï¼š\u0026#34; + f\u0026#34;{\u0026#39;, \u0026#39;.join(self.fields)}\\n\u0026#34; \u0026#34; - ä¿æŒå„å­—æ®µä¹‹é—´çš„å¯¹åº”å…³ç³»\\n\u0026#34; \u0026#34;2. ç‰¹æ®Šå†…å®¹å¤„ç†ï¼š\\n\u0026#34; \u0026#34; - ç»Ÿä¸€å¤„ç†è‹±æ–‡å¤§å°å†™ï¼ˆå¦‚ç¼©å†™ã€ä»£ç ç­‰ï¼‰\\n\u0026#34; \u0026#34; - è§„èŒƒåŒ–æ•°å­—æ ¼å¼ï¼ˆå¦‚ä»·æ ¼ã€ç¼–å·ç­‰ï¼‰\\n\u0026#34; \u0026#34; - å¤„ç†å¯èƒ½çš„é‡å¤ä¿¡æ¯\\n\u0026#34; \u0026#34;3. æ•°æ®å®Œæ•´æ€§ï¼š\\n\u0026#34; \u0026#34; - è¿”å›JSONæ ¼å¼ï¼Œç¡®ä¿æ¯ä¸ªå­—æ®µéƒ½å­˜åœ¨\\n\u0026#34; \u0026#34; - å¯¹æ— æ³•è¯†åˆ«çš„ä¿¡æ¯ä½¿ç”¨ç©ºå­—ç¬¦ä¸²\\n\u0026#34; \u0026#34; - ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§\\n\u0026#34; \u0026#34;4. ä¸Šä¸‹æ–‡å…³è”ï¼š\\n\u0026#34; \u0026#34; - åˆ©ç”¨ä¸Šä¸‹æ–‡è¡¥å……å¯èƒ½ç¼ºå¤±çš„ä¿¡æ¯\\n\u0026#34; \u0026#34; - ç¡®ä¿å…³è”å­—æ®µä¹‹é—´çš„é€»è¾‘æ€§\\n\u0026#34; \u0026#34; - å¤„ç†å¯èƒ½çš„äº¤å‰å¼•ç”¨\\n\u0026#34; \u0026#34;5. æ•°æ®æ¸…ç†ï¼š\\n\u0026#34; \u0026#34; - ç§»é™¤å¤šä½™çš„ç©ºæ ¼å’Œç‰¹æ®Šå­—ç¬¦\\n\u0026#34; \u0026#34; - ç»Ÿä¸€æ ¼å¼åŒ–å­—ç¬¦ä¸²\\n\u0026#34; \u0026#34; - ç¡®ä¿æ•°æ®çš„è§„èŒƒæ€§\\n\u0026#34; \u0026#34;è¯·ç›´æ¥è¿”å›JSONæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½åº”è¯¥æ˜¯åŒ…å«æ‰€æœ‰å¿…è¦å­—æ®µçš„å­—å…¸ã€‚ä¸è¦åŒ…å«ä»»ä½•å…¶ä»–è§£é‡Šæ–‡å­—ã€‚\u0026#34; ) # å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚è¿›è¡Œæ•°æ®æ•´ç† organize_response = self.client.chat.completions.create( model=\u0026#34;ep-20250117235826-zpdh8\u0026#34;, messages=[ { \u0026#34;role\u0026#34;: \u0026#34;user\u0026#34;, \u0026#34;content\u0026#34;: organize_prompt } ] ) if organize_response.choices and organize_response.choices[0]: # è§£ææ•´ç†åçš„æ•°æ® organized_results = json.loads(organize_response.choices[0].message.content) all_data.extend(organized_results) # ä½¿ç”¨extendè€Œä¸æ˜¯append print(f\u0026#34;å¤„ç†å®Œæˆå›¾ç‰‡ï¼š{img_info[\u0026#39;filepath\u0026#39;]}\u0026#34;) print(f\u0026#34;æ•´ç†åçš„ç»“æœï¼š{organized_results}\u0026#34;) except Exception as e: tk.messagebox.showerror(\u0026#34;é”™è¯¯\u0026#34;, f\u0026#34;å¤„ç†å›¾ç‰‡æ—¶å‡ºé”™ï¼š{str(e)}\u0026#34;) continue if all_data: try: # ç›´æ¥ä½¿ç”¨æ•´ç†åçš„æ•°æ®åˆ›å»ºDataFrame df = pd.DataFrame(all_data) # ä½¿ç”¨æŒ‡å®šè·¯å¾„ä¿å­˜Excel timestamp = datetime.datetime.now().strftime(\u0026#34;%Y%m%d_%H%M%S\u0026#34;) output_file = os.path.join(self.excel_output_path, f\u0026#34;æå–ç»“æœ_{timestamp}.xlsx\u0026#34;) df.to_excel(output_file, index=False) tk.messagebox.showinfo(\u0026#34;æˆåŠŸ\u0026#34;, f\u0026#34;æ•°æ®å·²ä¿å­˜åˆ°ï¼š{output_file}\u0026#34;) except Exception as e: tk.messagebox.showerror(\u0026#34;é”™è¯¯\u0026#34;, f\u0026#34;ä¿å­˜Excelæ–‡ä»¶æ—¶å‡ºé”™ï¼š{str(e)}\u0026#34;) def crop_current_image(self): \u0026#34;\u0026#34;\u0026#34;è£å‰ªå½“å‰æ˜¾ç¤ºçš„å›¾ç‰‡\u0026#34;\u0026#34;\u0026#34; if not self.images or self.current_display_index \u0026gt;= len(self.images): tk.messagebox.showwarning(\u0026#34;è­¦å‘Š\u0026#34;, \u0026#34;æ²¡æœ‰å¯è£å‰ªçš„å›¾ç‰‡ï¼\u0026#34;) return img_info = self.images[self.current_display_index] CropWindow(self.root, img_info[\u0026#39;filepath\u0026#39;], lambda cropped: self.on_crop_complete(cropped, self.current_display_index)) def on_crop_complete(self, cropped_image, index): \u0026#34;\u0026#34;\u0026#34;å¤„ç†è£å‰ªå®Œæˆçš„å›¾ç‰‡\u0026#34;\u0026#34;\u0026#34; if 0 \u0026lt;= index \u0026lt; len(self.images): self.images[index][\u0026#39;image\u0026#39;] = cropped_image self.refresh_thumbnail_view() self.update_main_display() def main(): root = tk.Tk() app = ImageProcessorApp(root) root.mainloop() if __name__ == \u0026#34;__main__\u0026#34;: main() ","date":"2025-01-13T00:00:00Z","permalink":"https://SweetGargamel.github.io/p/2p2epdfpic-to-excel/","title":"2P2Eï¼ˆPDF\u0026PIC to Excelï¼‰"},{"content":"è¯»ã€Šé£˜ã€‹ ä¸€äº›ä¸ªäººæ„Ÿæƒ³ å¯¹å¥¹çˆ±è¿‡çš„è¿™ä¸¤ä¸ªç”·äººï¼Œå¥¹è°éƒ½æ²¡æœ‰çœŸæ­£äº†è§£è¿‡ï¼Œæ‰€ä»¥æ‰éƒ½å¤±å»äº†ä»–ä»¬ã€‚ç›´åˆ°ç°åœ¨å¥¹æ‰æ¨¡æ¨¡ç³Šç³Šåœ°æ„è¯†åˆ°ï¼Œå¦‚æœå¥¹çœŸæ­£çš„äº†è§£è¿‡é˜¿å¸Œé‡Œï¼Œå¥¹å°±ç»ä¸ä¼šçˆ±ä¸Šä»–ï¼›å¦‚æœå¥¹çœŸæ­£äº†è§£è¿‡ç‘ç‰¹ï¼Œå¥¹ä¹Ÿå°±ç»ä¸ä¼šå¤±å»ä»–äº†ã€‚\nä»24å¹´æš‘å‡æˆ‘å°±å¼€å§‹æœ‰æƒ³æ³•ï¼Œåˆ°äº†å¤§å­¦ä»¥åè¦å¤šè¯»ä¸€äº›ç»å…¸åè‘—\næœç„¶ç»å…¸çš„åè‘—æ€»æ˜¯ä¼šç»™äººæ„ŸæŸ“åŠ›çš„ï¼Œä»åœ¨å¡”æ‹‰åº„å›­â€œé£å§¿ç¿©ç¿©â€çš„å°‘å¥³ï¼Œåˆ°æœ€åæ®‹é…·æ— æƒ…ã€å”¯åˆ©æ˜¯å›¾ç”šè‡³æœ‰äº›å‘é„™çš„å¤«äººï¼Œæˆ‘æ²¡æœ‰æƒ³åˆ°åå¹´å†…ï¼ˆç”šè‡³è¯´ä¸ç”¨åå¹´çš„æ—¶é—´ï¼Œä»…ä»…æ˜¯ä¸€åœºæˆ˜äº‰ï¼‰å°±èƒ½å¤Ÿè¿™ä¹ˆæ˜¾è‘—çš„æ”¹å˜äº†ä¸€ä¸ªäººçš„æ€§æ ¼ã€‚\nä¸€ä¸ªäººï¼Œæ´»ä¸€ä¸–æ€»æ˜¯è¦æœ‰äº›ç›¼å¤´æ‰èƒ½æ´»ä¸‹å»çš„ã€‚å¦åˆ™ä¸€ä¸ªäººä¹Ÿå°±â€œå¤±å»äº†æ‰€æœ‰çš„åŠ›æ°”å’Œæ‰‹æ®µâ€ã€‚æ”¯æŒæ–¯å˜‰ä¸½çš„ï¼Œä¸€å¼€å§‹æ˜¯â€œå°‘ç”·â€ä»¬çš„è¿½å´‡ï¼Œåœ¨ï¼Œåé¢åˆ™æ˜¯ä¸ºäº†è°‹ç”Ÿæ‰€å¿…é¡»çš„é’±å’Œåˆ©ç›Šã€‚å½“ç„¶ï¼Œè¿˜æœ‰å¥¹è¿½æ±‚äº†åå¤šå¹´çš„é˜¿å¸Œé‡Œã€‚å¥¹ä¸ºäº†å¥¹çš„ç›®æ ‡ï¼Œå¯ä»¥ä¸æ‹©ä¸€åˆ‡æ‰‹æ®µâ€”â€”å¯ä»¥å»æ¬ºéª—å¼—æœ—å…‹ï¼Œå¯ä»¥å»å‹æ¦¨ç½ªçŠ¯å’Œé»‘äººã€‚å¥¹å‹‡æ•¢ï¼Œå¥¹èƒ†å¤§ï¼Œå¥¹ç²¾æ˜èƒ½å¹²ï¼Œå¥¹æ— æ‰€é¡¾å¿Œï¼›å½“ç„¶å¥¹ä¹Ÿè¶³å¤Ÿå‘é„™ï¼Œè¶³å¤Ÿæ”¾æµªï¼Œè¶³å¤Ÿæ— æƒ…ã€‚å°±æ˜¯è¿™ç§è¿‘ä¹å†·è¡€çš„è¡Œä¸ºï¼Œè®©å¥¹è·å¾—äº†è¶³å¤Ÿçš„è´¢å¯Œã€å£°èª‰å’Œåœ°ä½ã€‚\nä½†æ˜¯è½¬è¿‡å¤´æ¥åˆ°æœ€åï¼Œå®é™…ä¸Šå¥¹å¤±å»äº†ä¸€åˆ‡ã€‚\nè¿™ä¹ˆé•¿æ—¶é—´ä»¥æ¥ï¼Œæˆ‘ä¸€ç›´ä¹Ÿåœ¨æ€è€ƒäººç”Ÿçš„ä»·å€¼å’Œæ„ä¹‰æ‰€åœ¨ï¼Œä¹Ÿæ›´åœ¨æ€è€ƒæ—¶ä»£ä¸ä¸ªäººçš„ç´§å¯†å…³ç³»ã€‚æˆ‘ä»¬ç©¶ç«Ÿæ˜¯ä¸ºäº†ä»€ä¹ˆè€Œæ´»ç€ï¼Œåˆç©¶ç«Ÿåœ¨è¿½æ±‚ç€ä»€ä¹ˆï¼Œæˆ‘ä»¬çš„æ—¶ä»£åˆä¼šæ€æ ·æ— ç§çš„é€æ¥/æ— æƒ…çš„å‰¥å¤ºæˆ‘ä»¬çš„æ‰€æ±‚æ‰€çˆ±çš„ä¸€ä»¶ä»¶äº‹ç‰©ã€‚\nå› ä¸ºæŸäº›äº‹æƒ…ï¼Œæˆ‘å¯èƒ½å¯¹äºâ€œå‘½è¿â€äºŒå­—æ ¼å¤–ç›¸ä¿¡ã€‚æˆ‘å¯èƒ½æœ‰ä¸€ç‚¹è½å…¥ç½—ç¿”è€å¸ˆæ‰€è¯´çš„â€œå®¿å‘½è®ºâ€çš„èŒƒç•´ã€‚è™½ç„¶æˆ‘è‡ªè®¤ä¸ºåŠªåŠ›ä¼šæœ‰æˆæœï¼Œä½†æ˜¯æˆ‘å¯èƒ½æ›´ç›¸ä¿¡å‘½è¿çš„å®‰æ’ã€‚è¯´å¥ä¸å¥½å¬çš„ï¼Œå¦‚æœä¸æ˜¯ä¸Šå¤©ç»™äº†æˆ‘ä¸€å‰¯è¿˜ç®—æ“…é•¿æ–‡åŒ–çŸ¥è¯†å­¦ä¹ çš„å¤´è„‘ï¼Œæˆ‘åˆæ€ä¹ˆèƒ½å¤Ÿç°åœ¨æ¥åˆ°NJUè¯»ä¹¦å‘¢ï¼Ÿæ‰€ä»¥ï¼Œæˆ‘ç°åœ¨å¯èƒ½æ›´æ„¿æ„ç›¸ä¿¡ä¸Šå¤©èµ‹äºˆæˆ‘çš„ä¸œè¥¿å§â€”â€”å¾—ä¹‹æˆ‘å¹¸ï¼Œä¸å¾—æˆ‘å‘½ã€‚å³ä¾¿æ˜¯è®¸å¤šæ—¶å€™åˆ«äººçš„é£å…‰ï¼ŒèƒŒåå¯èƒ½æ˜¯æ— æ•°çš„è‹¦ç—›ä¸æŠ˜ç£¨ï¼Œè€Œæˆ‘â€œåˆä½•ç¾¡ä¹â€ï¼Ÿ\næˆ‘çŸ¥é“æœ‰äº›å¾€äº‹æ°¸è¿œæ— æ³•æ•£å»ï¼Œé‚£ç§ç—›è‹¦å¯èƒ½è¦å‡ å¹´ç”šè‡³åå‡ å¹´çš„æ—¶å…‰çš„ç¨€é‡Šã€‚ä½†æ˜¯æˆ‘ä¸å¸Œæœ›æˆ‘å’Œæ–¯å˜‰ä¸½ä¸€æ ·ï¼Œå†ä¸ºäº†æŸäº›è™šæ— ç¼¥ç¼ˆçš„ä¸œè¥¿è€Œå¤±å»ã€é”™è¿‡æ‰€çˆ±çš„äººå§ã€‚æˆ‘åªå¸Œæœ›è‡ªå·±èƒ½å¤Ÿå¿«ç‚¹æ‰¿æ‹…èµ·è‡ªå·±çš„è´£ä»»ï¼Œå»é™ªå¥¹ä¸€èµ·èµ°è¿‡äººç”Ÿçš„æ˜¥å¤ç§‹å†¬ã€‚\nGone with the wind\nGone with the wind\nå°±è®©å¾€äº‹éšé£é£˜å»\nBy SweetGargamel\n","date":"2025-01-13T00:00:00Z","image":"https://SweetGargamel.github.io/p/%E8%AF%BB%E9%A3%98/cover_hu9023313130133434017.png","permalink":"https://SweetGargamel.github.io/p/%E8%AF%BB%E9%A3%98/","title":"è¯»ã€Šé£˜ã€‹"},{"content":"è§£æSICP-Proj4 EC æœ¬æ–‡ç« è¯·æ­é…NJU-SICP Project04 EC (Adopted from CS61A from Berkeley) é£Ÿç”¨\nWritten By SweetGargamel\nIntroduction - proj04: Scheme\nDebugging Guide - proj04: Scheme\nåŸé—®é¢˜ Why current interpreter cannot properly process tail call? Consider such scheme code:\n1 2 3 4 5 6 (define (factor n acc) (if (= n 0) acc (factor (- n 1) (* acc n)))) (factor 10 1) The current evaluation process is:\n1 2 3 4 scheme_eval(`(factor 10 1)) ===\u0026gt; return scheme_eval(`(factor 9 10)) ===\u0026gt; return (return scheme_eval(`(factor 8 90))) ... The problem isÂ pythonÂ interpreter does not properly perform tail call.\nThere\u0026rsquo;re mainly three way to solve this problem:\ntransform the scheme interpreter to anÂ non-recursiveÂ interpreter, i.e., eliminate all recursive call toÂ scheme_eval. That can be accomplished by rewrite this interpreter to anÂ CEKÂ interpreter. (\u0026lsquo;C\u0026rsquo; meansÂ control, \u0026lsquo;E\u0026rsquo; meansÂ environment, \u0026lsquo;K\u0026rsquo; meansÂ continuation). SeeÂ hereÂ and Chap. 5 ofÂ ESSENTIALS OF PROGRAMMING LANGUAGES. rewrite this interpreter to anÂ trampolinedÂ interpreter.Â We use this approach. transform the source scheme code, e.g.Â Continuation-Passing StyleÂ transformation. TheÂ trampolineÂ technique is the simplest one. So we use this approach.\nTrampoline The trampoline technique is a simple technique to perform proper tail call in a \u0026ldquo;bad\u0026rdquo; language (e.g. Python, C, C++, Java, \u0026hellip;).\nFor example, we can define aÂ sumÂ recursive function in python:\n1 2 3 4 5 def sum(n, acc): if n == 0: return acc else: return sum(n - 1, acc + n) AndÂ sum(10000, 0)Â will produce aÂ StackOverflowÂ error. Now we \u0026ldquo;trampoline\u0026rdquo; such function:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 class Unevaluated: def __init__(self, n, acc): self.n = n self.acc = acc def sum_tram(n, acc): if n == 0: return acc else: return Unevaluated(n - 1, acc + n) def sum(n, acc): # use do-while here is better, but Python does not support that res = sum_tram(n, acc) while isinstance(res, Unevaluated): res = sum_tram(res.n, res.acc) return res NowÂ sum(10000, 0)Â will properly works. This can be generalized to transform all recursive functions to loops, seeÂ here. But the above form is enough for our problem.\nThe Tasks Complete the functionÂ optimize_tail_callsÂ inÂ scheme_eval_apply.py. It returns an alternative toÂ scheme_evalÂ that is properly tail recursive. That is, the interpreter will allow an unbounded number of active tail calls in constant space. It has a third argumentÂ tailÂ that indicates whether the expression to be evaluated is in a tail context.\nTheÂ UnevaluatedÂ class represents an expression that needs to be evaluated in an environment. WhenÂ optimized_evalÂ receives a non-atomic expression in a tail context, it returns anÂ UnevaluatedÂ instance. Otherwise, it should repeatedly callÂ original_scheme_evalÂ until the result is a value, rather than anÂ Unevaluated.\nA successful implementation will require changes to several other functions, including some functions that we provided for you.Â All expressions throughout your interpreter that are in a tail context should be evaluated by callingÂ scheme_evalÂ withÂ TrueÂ as the third argument (now calledÂ tail). Your goal is to determine which expressions are in a tail context throughout your code and change calls toÂ scheme_evalÂ as needed.\nOnce you finish, uncomment the following line inÂ scheme_eval_apply.pyÂ to use your implementation:\nscheme_eval = optimize_tail_calls(scheme_eval)\nç–‘æƒ‘å¼•å‡º é—®é¢˜ 1 2 3 4 5 6 7 8 def optimize_tail_calls(original_scheme_eval): def optimized_eval(expr, env, tail=False): if tail and not scheme_symbolp(expr) and not self_evaluating(expr): return Unevaluated(expr,env) # BEGIN PROBLEM EC # END PROBLEM EC return optimized_eval æ˜¯çš„ï¼Œå¾ˆæ˜¾ç„¶ä½ ä¼šä¸ä¼šè§‰å¾—ï¼Œå¼€å§‹åœ¨è¿è¡Œç¬¬ä¸€è¡Œä»£ç çš„æ—¶å€™ï¼Œå¦‚æœæ˜¯å°¾é€’å½’çš„è¯å°±ä¼šç›´æ¥è¿”å›ä¸€ä¸ªUnevaluatedçš„ç©æ„ï¼Œè¿™ç¨‹åºä¸å°±è¯¥å´©äº†å—ï¼Ÿ ç­”æ¡ˆ 1 2 3 4 5 6 7 8 9 10 11 def optimize_tail_calls(original_scheme_eval): def optimized_eval(expr, env, tail=False): if tail and not scheme_symbolp(expr) and not self_evaluating(expr): return Unevaluated(expr,env) # BEGIN PROBLEM EC res=original_scheme_eval(expr, env) while isinstance(res, Unevaluated): res = original_scheme_eval(res.expr, res.env) return res # END PROBLEM EC return optimized_eval æ˜¯çš„ä½ çœ‹äº†ç­”æ¡ˆä¼šä¸ä¼šæ›´è§‰å¾—ä¸‹é¢çš„ä»£ç æ ¹æœ¬å°±è¿è¡Œä¸åˆ°ï¼Ÿ ï¼ˆå½“ç„¶é™¤äº†è¯¥è¿™äº›ä»£ç è¿˜åº”è¯¥æŒ‰ç…§åŠ©æ•™çš„å»ºè®®ï¼ŒæŠŠå‡¡æ˜¯å°¾é€’å½’çš„éƒ¨åˆ†éƒ½ç»™åŠ ä¸€ä¸ªtail=Trueçš„å‚æ•°ï¼‰ ä½¿ç”¨Vscodeçš„DebugåŠŸèƒ½è§£æ æ€ä¹ˆä½¿ç”¨Debug ç›´æ¥æŒ‰ç…§åŠ©æ•™çš„æç¤ºä¿®æ”¹.vscode/launch.jsonæ–‡ä»¶å³å¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 { \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Python: Current File\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;python\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;program\u0026#34;: \u0026#34;scheme.py\u0026#34;, \u0026#34;args\u0026#34;:[ \u0026#34;-i\u0026#34;, \u0026#34;tests.scm\u0026#34; ], \u0026#34;console\u0026#34;: \u0026#34;integratedTerminal\u0026#34;, \u0026#34;justMyCode\u0026#34;: true, } ] } ä½ å¯ä»¥ä¿®æ”¹tests.scmé‡Œé¢çš„æµ‹è¯•ç”¨ä¾‹æ¥æµ‹è¯•ï¼Œä¸‹é¢æ˜¯æˆ‘çš„ä¾‹å­ 1 2 3 4 5 6 (define (factor n acc) (if (= n 0) acc (factor (- n 1) (* acc n)))) (factor 10 1) å½“ç„¶åˆ«å¿˜æ‰“æ–­ç‚¹äº†\nDebugï¼Œå¯åŠ¨ï¼ ç‚¹å‡»Start Debugging\nç„¶åä½ ä¼šå‘ç°å·¦è¾¹å‡ºæ¥è¿™äº›ä¸œè¥¿ï¼Œåˆ†åˆ«æ˜¯ä½ çš„VARIABLESã€WATCHã€CALL_STACK\nVARIABLESæ˜¯å½“å‰çš„å˜é‡ WATCHå¯ä»¥æ·»åŠ è‡ªå·±æƒ³çœ‹çš„è¡¨è¾¾å¼æˆ–è€…å˜é‡çš„å€¼ CALL_STACKçœ‹è°ƒç”¨çš„å †æ ˆ æˆ‘ä»¬å‘ç°ä»–åœåˆ°äº†ifè¿™ä¸ªè¯­å¥åœä¸‹æ¥äº†\nç°åœ¨è§£é‡Šå™¨åœ¨å¹²å•¥ï¼Ÿ æˆ‘ä»¬å‘ç°å·¦ä¸Šè§’çš„exprçš„ç¬¬ä¸€ä¸ªsymæ˜¯defineï¼Œè¯´æ˜ä»–æ­£åœ¨è¿›è¡Œdo_define_form æ€ä¹ˆè®©è§£é‡Šå™¨å¾€ä¸‹èµ°ï¼Ÿ åœ¨æœ€ä¸Šé¢æœ‰å‡ ä¸ªæŒ‰é’®ï¼Œåˆ†åˆ«æ˜¯ä¸‹é¢å‡ ä¸ª Step Into å¦‚æœå½“å‰è¯­å¥æ˜¯ä¸€ä¸ªcall expressionï¼Œä»–å°±ä¼šè¿›å…¥å‡½æ•°ä½“è®©ä½ çœ‹å‡½æ•°ä½“å†…éƒ¨æ˜¯æ€ä¹ˆæ‰§è¡Œçš„ï¼›å¦åˆ™å’ŒStep Overä¸€æ ·ã€‚ Step Overï¼šä¸ç®¡æ˜¯å¦æ˜¯call expressionç›´æ¥å½“ä¸€æ¡æ™®é€šè¯­å¥è¿è¡Œè¿‡å»ã€‚ Step Outï¼šè·³å‡ºå½“å‰Frameï¼ˆæ¯”å¦‚Aé‡Œé¢è°ƒç”¨äº†Bå‡½æ•°ï¼Œæˆ‘ç°åœ¨é€šè¿‡Step Intoè¿›å…¥äº†Bæ‰€åœ¨çš„Frame,Step Outå°±ç›´æ¥å›åˆ°Aé‡Œé¢ï¼‰ æ‰€ä»¥æˆ‘ä»¬æŒ‰Step Intoï¼Œä½ ä¼šå‘ç°ä»–è·³è¿‡äº†ä¸Šé¢çš„ifè¯­å¥ï¼›è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ç°åœ¨æ˜¯åœ¨do_define_formï¼Œå¹¶ä¸æ˜¯å°¾é€’å½’æ“ä½œï¼Œæ‰€ä»¥å°±è°ƒç”¨åŸå§‹çš„eval_call. æˆ‘ä»¬å†æ¬¡é€‰æ‹©Step Intoï¼Œå‘ç°ï¼š è¿™ä¸ªéƒ¨åˆ†å°±æ¯”è¾ƒå¥½ç†è§£äº†ï¼Œä»–å°±æ˜¯åœ¨åšdefineçš„å†…å®¹ï¼Œæˆ‘å°±ä¸è§£é‡Šäº†ã€‚\nåšå®Œdefine formä¹‹å æŒ‰ç…§è§£é‡Šå™¨è§£é‡Šçš„è§„åˆ™ï¼Œæˆ‘ä»¬æŠŠfactorç»‘å®šåˆ°å¯¹åº”çš„lambdaå‡½æ•°ä¹‹åï¼Œå°±ä¼šæ‰§è¡Œ(factor 10 1) é‚£ä¹ˆä»–çš„çš„æ‰§è¡Œé¡ºåºå°±æ˜¯ï¼ˆè¯·ä½ æ³¨æ„çœ‹å·¦ä¸‹è§’çš„CALL_STACKï¼‰\neval factor eval 10 eval 1 å›¾ç•¥ï¼Œç±»ä¼¼ä¸Šé¢ apply lambda 10 1 æˆ‘ä»¬å‘ç°è¿™äº›éƒ½ä¸æ˜¯å°¾é€’å½’ï¼›\nåœ¨è¿™ä¸€æ­¥ä¹‹åé€‰æ‹©Step Into\nè¿›å…¥applyè¿‡ç¨‹ï¼ ä½ ä¼šå‘ç°applyåï¼Œä»–å°±åœ¨do_if_formã€‚æ³¨æ„ï¼Œåœ¨è°ƒç”¨do_if_formçš„æ—¶å€™å‚æ•°tail=True è¿™é‡Œç»§ç»­é€‰æ‹©Step into\nç„¶åå°±åˆ°äº†æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œè¿™é‡Œç»ˆäºä¼šæœ‰Unevaluatedç±»äº§ç”Ÿäº†ï¼ˆä¸‹é¢éƒ½ç®€å†™ä¸ºunç±»ï¼‰ è¿™é‡Œä½ è¦æ€è€ƒï¼Œæˆ‘çš„unç±»è¿”å›åˆ°å“ªé‡Œäº†ï¼Ÿä½ ç‚¹ä¸€ä¸‹Step Intoï¼Œå‘ç°è¿™ä¸ªä¸œè¥¿æ˜¯è¿”å›åˆ°äº†scheme_evalé‡Œé¢ã€‚\né‚£ä¹ˆä»–æ˜¯åœ¨evalè°ï¼Ÿä½ çœ‹å·¦è¾¹çš„Variablesï¼Œè¿™ä¼šæ­£åœ¨åšdo_define_formã€‚ ç„¶åä½ å°±ä¼šå‘ç°ä»–å›åˆ°äº†æœ€å¤–å±‚çš„applyçš„è¿‡ç¨‹ è¯¶ä½ æ˜¯ä¸æ˜¯å‘ç°ï¼Œè¿™é‡Œä¸Šé¢è™½ç„¶æœ€å·¦è¾¹çš„tailæ˜¯false,ä½†æ˜¯è¿™é‡Œè¿”å›äº†unç±»ã€‚\næ€è·¯ç†é¡º é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬å‘ç°ï¼Œå®é™…ä¸Šunç±»å¹¶ä¸ä¼šâ€æ¼å‡ºå»â€œï¼Œå®é™…ä¸Šä»–æ˜¯é€šè¿‡å¥½å±‚çš„é€’å½’è°ƒç”¨ï¼Œåœ¨æœ€å¤–å±‚çš„eval_callï¼ˆevalçš„æ˜¯å‡½æ•°çš„call-expression)æ‹¿åˆ°äº†æœ€é‡Œå±‚eval_callï¼ˆè¿™é‡Œæ˜¯do_if_formï¼‰è¿”å›çš„unç±»ï¼Œç„¶åå†å¾ªç¯å¾€å¤çš„evalã€‚\nåæ€æ€»ç»“ æˆ‘å’Œxshå’ŒfhyåŒå­¦éƒ½äº¤æµè¿‡ï¼Œä»–ä»¬ä¼¼ä¹éƒ½æ„Ÿè§‰æœ€åè¿™ä¸ªunç±»ä¼šè¢«è¿”å›åˆ°æœ€å¤–å±‚ï¼Œä»è€Œä½ æœ€åçš„evalç»“æœéƒ½æ˜¯ä¸€ä¸ªunç±»ã€‚è¯´æ˜è¿™åº”è¯¥æ˜¯è®¸å¤šåŒå­¦çš„å…±åŒçš„é—®é¢˜ ç„¶è€Œé€šè¿‡Debugçš„é€å¥è°ƒç”¨ï¼Œæˆ‘ä»¬å‘ç°é ç©ºæƒ³æ˜¯ä¸è¡Œçš„ï¼Œéœ€è¦æ·±å…¥çš„ä¸€è¡Œè¡ŒæŠŠè‡ªå·±å½“ç¼–è¯‘å™¨ç†è§£ã€‚Debugåº”è¯¥æ˜¯æˆ‘ä»¬è¦æŒæ¡çš„ä¸€é—¨æŠ€æœ¯ã€‚ æœ€åå†æ¬¡æ„Ÿè°¢åŠ©æ•™ã€å„ä½åŒå­¦çš„å¸®åŠ©ï¼\n","date":"2025-01-08T00:00:00Z","image":"https://SweetGargamel.github.io/p/%E8%A7%A3%E6%9E%90sicp-proj4-ec/CoverImg_hu14838150606946409445.png","permalink":"https://SweetGargamel.github.io/p/%E8%A7%A3%E6%9E%90sicp-proj4-ec/","title":"è§£æSICP-Proj4 EC"},{"content":"This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nHeadings The following HTML \u0026lt;h1\u0026gt;â€”\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1 H2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution Tiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\nâ€” Rob Pike1\nTables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables Italics Bold Code italics bold code A B C D E F Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, sapien non euismod aliquam, dui ligula tincidunt odio, at accumsan nulla sapien eget ex. Proin eleifend dictum ipsum, non euismod ipsum pulvinar et. Vivamus sollicitudin, quam in pulvinar aliquam, metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula. Ut bibendum vestibulum quam, eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra. Vivamus vitae pretium sapien Code Blocks Code block with backticks 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block with Hugo\u0026rsquo;s internal highlight shortcode 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Diff code block 1 2 3 4 5 [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;] List Types Ordered List First item Second item Third item Unordered List List item Another item And another item Nested list Fruit Apple Orange Banana Dairy Milk Cheese Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL + ALT + Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nHyperlinked image ![[fbd3eea69cc016df702f2f87583a19e8_MD5.png]]\nThe above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2019-03-11T00:00:00Z","image":"https://SweetGargamel.github.io/p/markdown-syntax-guide/pawel-czerwinski-8uZPynIu-rQ-unsplash_hu6307248181568134095.jpg","permalink":"https://SweetGargamel.github.io/p/markdown-syntax-guide/","title":"Markdown Syntax Guide"},{"content":"Lorem est tota propiore conpellat pectoribus de pectora summo.\nRedit teque digerit hominumque toris verebor lumina non cervice subde tollit usus habet Arctonque, furores quas nec ferunt. Quoque montibus nunc caluere tempus inhospita parcite confusaque translucet patri vestro qui optatis lumine cognoscere flos nubis! Fronde ipsamque patulos Dryopen deorum.\nExierant elisi ambit vivere dedere Duce pollice Eris modo Spargitque ferrea quos palude Rursus nulli murmur; hastile inridet ut ab gravi sententia! Nomine potitus silentia flumen, sustinet placuit petis in dilapsa erat sunt. Atria tractus malis.\nComas hunc haec pietate fetum procerum dixit Post torum vates letum Tiresia Flumen querellas Arcanaque montibus omnes Quidem et Vagus elidunt The Van de Graaf Canon\nMane refeci capiebant unda mulcebat Victa caducifer, malo vulnere contra dicere aurato, ludit regale, voca! Retorsit colit est profanae esse virescere furit nec; iaculi matertera et visa est, viribus. Divesque creatis, tecta novat collumque vulnus est, parvas. Faces illo pepulere tempus adest. Tendit flamma, ab opes virum sustinet, sidus sequendo urbis.\nIubar proles corpore raptos vero auctor imperium; sed et huic: manus caeli Lelegas tu lux. Verbis obstitit intus oblectamina fixis linguisque ausus sperare Echionides cornuaque tenent clausit possit. Omnia putatur. Praeteritae refert ausus; ferebant e primus lora nutat, vici quae mea ipse. Et iter nil spectatae vulnus haerentia iuste et exercebat, sui et.\nEurytus Hector, materna ipsumque ut Politen, nec, nate, ignari, vernum cohaesit sequitur. Vel mitis temploque vocatus, inque alis, oculos nomen non silvis corpore coniunx ne displicet illa. Crescunt non unus, vidit visa quantum inmiti flumina mortis facto sic: undique a alios vincula sunt iactata abdita! Suspenderat ego fuit tendit: luna, ante urbem Propoetides parte.\n","date":"2019-03-09T00:00:00Z","image":"https://SweetGargamel.github.io/p/placeholder-text/matt-le-SJSpo9hQf7s-unsplash_hu10664154974910995856.jpg","permalink":"https://SweetGargamel.github.io/p/placeholder-text/","title":"Placeholder Text"},{"content":"Mathematical notation in a Hugo project can be enabled by using third party JavaScript libraries.\nIn this example we will be using KaTeX\nCreate a partial under /layouts/partials/math.html Within this partial reference the Auto-render Extension or host these scripts locally. Include the partial in your templates like so: 1 2 3 {{ if or .Params.math .Site.Params.math }} {{ partial \u0026#34;math.html\u0026#34; . }} {{ end }} To enable KaTeX globally set the parameter math to true in a project\u0026rsquo;s configuration To enable KaTeX on a per page basis include the parameter math: true in content files Note: Use the online reference of Supported TeX Functions\nExamples Inline math: $\\varphi = \\dfrac{1+\\sqrt5}{2}= 1.6180339887â€¦$\n$$ \\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$","date":"2019-03-08T00:00:00Z","permalink":"https://SweetGargamel.github.io/p/math-typesetting/","title":"Math Typesetting"},{"content":"Emoji can be enabled in a Hugo project in a number of ways.\nThe emojify function can be called directly in templates or Inline Shortcodes.\nTo enable emoji globally, set enableEmoji to true in your site\u0026rsquo;s configuration and then you can type emoji shorthand codes directly in content files; e.g.\nğŸ™ˆ :see_no_evil: ğŸ™‰ :hear_no_evil: ğŸ™Š :speak_no_evil:\nThe Emoji cheat sheet is a useful reference for emoji shorthand codes.\nN.B. The above steps enable Unicode Standard emoji characters and sequences in Hugo, however the rendering of these glyphs depends on the browser and the platform. To style the emoji you can either use a third party emoji font or a font stack; e.g.\n1 2 3 .emoji { font-family: Apple Color Emoji, Segoe UI Emoji, NotoColorEmoji, Segoe UI Symbol, Android Emoji, EmojiSymbols; } ","date":"2019-03-05T00:00:00Z","image":"https://SweetGargamel.github.io/p/emoji-support/the-creative-exchange-d2zvqp3fpro-unsplash_hu5876398126655421130.jpg","permalink":"https://SweetGargamel.github.io/p/emoji-support/","title":"Emoji Support"}]